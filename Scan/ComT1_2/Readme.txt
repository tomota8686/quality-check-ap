****************************************************************
	シリアル通信解析ツール ComT
	
	ComT.EXE　　Ver1.2

	Copyright (C) 2008-2010  S.Kohno  All Rights Reserved

****************************************************************
--------------------------------------------
ソフトウェア概要
--------------------------------------------
　RS２３２Cシリアル通信のテスト、解析を行うツールです。
　シリアル通信を含んだソフト開発などの通信テストに利用できます。

　ソフトを起動するとメインCOMポートを初期化し送受信できる状態になります。

　上部メインウィンドウは、送信用ウィンドウですが、ラインモニタ時は、メインポートの
　受信ウィンドウになります。
　下部サブウィンドウは、受信ウィンドウです。ラインモニタ時は、サブポートの
　受信ウィンドウになります。
　受信データは、HEX, CHR, TXT, TXT2 の４種類の表示を行います。（下記参照）
　モデム信号ステータスを表示します。
　メニュー、ツールバーボタン等の動作内容は、ツールチップテキスト、フライバイテキスト
　（ステータスバー）に表示されますので、大体分かると思います。


----------------------------------------
ソフトウェア主機能
----------------------------------------
　データ送信機能
　データ受信機能
　通信テスト機能
　ファイル転送機能
　ラインモニタ機能
　テキストエディタ機能
　送受信データの保存、読込、印刷ができます。（下記、ファイル読込、書込時の注意点 参照）


--------------------
インストール、実行
--------------------
　ファイルを解凍しますと

　ComT 1_2 のフォルダの中に
　ComT.exe　　　　　　･････　シリアル通信テスト実行ファイル
　Readme.txt　　　　　･････　このファイル
　CtrlCode.txt        ･････  制御文字一覧
　の３つのファイルが生成されます。

　ComT 1_2　のフォルダを適当な場所に置いて、実行してください。
　実行すると ComT.ini ファイルが生成されます。


--------------------
アンインストール
--------------------
　ComT 1_2　のフォルダごと削除してください。
　レジストリは使用していません。


-------------------------------
受信データの表示モードについて
-------------------------------
　ツールバーボタンで４種類の表示モードが選択できます。
　HEXモード：16進数で表示します。
　CHRモード：キャラクタ表示（キャラクタ、制御文字、16進数　混在で表示します）
　TXTモード：テキスト表示　0x00 のみ・に変換します。
　TXT2モード:テキスト表示２ 0x00 は・に変換、対応文字のないコードは * に変換します。


---------------------
通信ポートの設定
---------------------
　立ち上げ時は、最後に終了した条件に設定されます。
　Main Port コンボボックスメインでポートを設定します。
　ポートが使用中もしくは対応していない場合は、" Invalid Com Port !! " と
　表示されますので、他のポートを選択し直してください。

　ラインモニタモードでは、
　Sub Port コンボボックスでサブポートを設定します。
　ポートが使用中もしくは対応していない場合は、"XXXXXX" と表示されますので、
　他のポートを選択し直してください。
　サブポートの通信条件は、メインポートに合わせます。


---------------------
通信条件の設定
---------------------
　通信　→　通信パラメータを選択、もしくは
　ダイアログバーのパラメータ表示ラベルの上でダブルクリックすると
　パラメータ設定ダイアログが開きます。

　なお、設定条件が、ハード的にサポートされているかどうかのチェックは
　行っていません。


--------------------
データ送信
--------------------
　メニュー　通信　→　送信指示ダイアログで送信指示ダイアログを開く。
　または、ツールバーの送信指示ダイアログボタンを押す。

　送信指示ダイアログが開いた状態でデータが送信できます。

　送信ダイアログに表示されているデータを下記の方法で送信できます。

　１）１ライン送信
　　　カーソルのある行を送信します。
　　　（行の上でダブルクリックしてもその行を送信できます。）
　２）ブロック送信
　　　空行で区切られたカーソルのあるブロックを送信します。
　３）選択送信
　　　マウスで選択したブロックを送信します。
　４）全文送信
　　　メインウィンドウのすべてのデータを送信します。
　５）Enterキー送信
　　Enterキーで１ライン送信をチェックすると送信ウィンドウで送信データを入力時、
　　Enterキーを押すとその行を送信することができます。

　正常に出力されれば、ステータスバーに送信したバイト数(送信ラインNo)が表示されます。


　・制御文字コード変換送信
　　制御文字、１６進文字のコード変換をチェックすると
　　＜＞で括られた制御文字、１６進文字をコードに変換し送信できます。

　　送信する文字列には、< > でくくった
　　制御文字 <NUUL><SHO><STX>････   （大文字で入力のこと）, 
　　16進コード <00><01>･･･<ff>　　　　　　　（小文字で入力のこと）
　　を埋め込むことが出来ます。

　　送信文字列として認識できる制御文字は、別ファイル CtrlCode.txt を参照してください。

　
--------------------
制御コード設定
--------------------
　メニュー　通信　→　制御コード設定ダイアログを開く。
　または、ツールバーの CODEボタンを押す。

　制御コード設定ダイアログのコードボタンを押すとそのコードが送信ウィンドウに
　設定されます。
　エディットボックスに１６進コードを入力し送信ボタンを押すと入力コードが送信
　ウィンドウに設定されます。

　直接送信チェックすると送信ウィンドへのコード設定と同時に送信されます。

　
--------------------
HEX表示
--------------------
　受信データの特定部分を１６進コードを見たい時に使用します。
　受信ウィンドウで変換したい部分をマウスで選択しHEXボタンを押すとHEX変換ダイアログが
　開き、変換コードが表示されます。
　送信ウィンドウでは、機能しません。
　また、HEX表示モード、CHR表示モードでは、機能しません。


--------------------
通信テスト
--------------------
　メニュー　通信　→　通信テスト　でテストダイアログを開く。
　送信バイト数、送信間隔を指定してStartボタンを押すとデータを送信します。

　送信したデータは相手マシンの受信（サブ）ウィンドウに表示されます。
　受信（サブ）ウィンドウには、受信データ、受信カウント（OK, NG, Total ）を表示します。
　受信バイト数が異なる場合、また受信データが１バイトでも異なればNGとしてカウントします。
　このテストでは、ハンドシェークは行なっていません。

　ループバックテスト
　ピン番号　2-3, 7-8, 1-4-6-9　を結線したコネクタを使用すれば、ポート単体で
　通信機能のテストができます。


--------------------
ファイル転送
--------------------
　メニュー　通信　→　ファイル転送　で送受信ダイアログが開く
　受信側でフォルダを選択、送信側でファイルを選択しStartボタンを押す。

　ファイルのタイムスタンプ、ファイル属性もコピーします。
　リードオンリーファイル、隠しファイル、システムファイルも転送出来ます。
　送信データは、チェックサムにて信頼性を確保しています。


--------------------
ラインモニタ
--------------------
　マシンにシリアルポートが２ポートあれば簡易ラインモニタとして使用できます。
　ツールバーのLineボタンを押すとラインモニタモードになります。

　メインウィンドウ−　メインポートの受信ウィンドウになります。
　サブウィンドウ　−　サブポートの受信ウィンドウになります。

　ラインモニタモードの切替えは送信側を停止してから行ってください。

　注意：受信データが多くなりますと処理が重くなりますので、適当にウィンドウをクリアしてください。

　また、長時間通信する場合は、ツールバーのStopボタンを押すとウィンドウの表示、受信データの
　バッファリングを一時的に止めることができます。なお表示を止めても送受信は継続しています。
　表示をとめれば、受信済みデータの確認、解析がし易くなります。

　注）メインポート、サブポートの送受信は、完全に別スレッド、別ウィンドウで処理をしているため、
　　　両ポートの送受信がクリティカルなタイミングの場合、前後関係が分かりにくいかもしれません。


--------------------
テキストエディタ
--------------------
　メインウィンドウは、基本的なテキストエディタの機能を備えています。

　ファイルの保存、読込、印刷、プレビューは、
　処理したい画面をマウスクリックでアクティブにした後、処理を実行してください。


------------------------------
ファイル読込、書込時の注意点
------------------------------
　 ファイルの読書は、テキストファイルを想定しています。

　ファイル読込：　メインウィンド（送信ウィンドウ）にのみ読み込み可能。

　ファイル書込：  HEX、CHR、TXT２ モードではテキストファイルですが、TXTモードでは
　　　　　　　　　   制御コード等が含まれている可能性がありますので、その場合、正常に
　　　　　　　　　   書込出来ません。


--------------------
ウィンドウ分割
--------------------
　ヘルプ　→　次回ウィンドウ分割

　ウィンドウ分割方向の横、縦を変更することが出来ます。
　次回の立上げ時に変更されます。

　ラインモニタ時は、縦分割の方が見やすいかも知れません。



----------------------------------------
動作環境
----------------------------------------
　DOS-V　マシン
　Microsoft　Windows　98、NT、2000、XP
　Microsoft　クラスライブラリ　MFC42.dll
           このライブラリは、Windowsのシステムに存在します。

　動作確認は、主にWondows 2000, XPで行なっていますが、
　特殊なコンポーネント等は使用していませんので、
　通常のウィンドウズ環境であれば動作すると思います。


----------------------------------------
ソフトウェア開発環境
----------------------------------------
　DOS-V　マシン
　Microsoft　Windows　2000, XP
　Microsoft　Visual　C++　Ver6.0


----------------------------------------
著作権、免責事項
----------------------------------------
　本ソフトウェアはフリーソフトですが、著作権は作者S.Kohnoが所有しております。
　本ソフトウェアの使用によって生じたいかなる損害も作者が補償するものではありません。
　本ソフトウェの利用は利用者の責任の範囲で行なってください。


----------------------------------------
メッセージ
----------------------------------------
　通信といえばネットワーク通信がですが、ＦＡ環境ではシリアル通信がまだまだ多く
　使用されています。（バーコードリーダー、計測器、シーケンサー接続など）
　今回、簡単にテスト、解析できるツールがあればという思いで作成しました。

　お気付きの点があればメールにてご連絡をお願い致します。


****************************************************
　S.Kohno in Matsuyama.
　E-Mail ：　skohno7973@kpd.biglobe.ne.jp
****************************************************

*************************************************
	改版履歴
*************************************************
2009.02.01 (Ver1.1.1)	Ｖｅｃｔｏｒ公開

2010.06.20 (Ver1.2)
　レジストリをINIファイルへ変更。
　送信機能の強化。
　サブウィンドウの印刷、保存方法を変更。
　制御文字のコード変換モジュールを一部修正。


